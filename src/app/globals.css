@import "tailwindcss";
@plugin "@tailwindcss/typography";

@custom-variant dark (&:where(.dark, .dark *));

@theme {
  /* Next.js에서 넘겨준 CSS 변수(--font-galmuri11)를 매핑하고, Fallback 폰트 추가 */
  --font-galmuri11: var(--font-galmuri11), sans-serif;
  --font-galmuri9: var(--font-galmuri9), sans-serif;
  --font-galmuri-mono: var(--font-galmuri-mono), sans-serif;
}

html {
    /* 스크롤바가 없어도 자리 차지하게 만들어서 레이아웃 흔들림 방지 */
    scrollbar-gutter: stable;
}

/* 모든 요소의 둥근 모서리 제거 */
* {
    border-radius: 0 !important;
}

.plink {
    color: #2f9e44;
    text-decoration: none;
}

/* 배경의 격자 */
body {
    background-size: 40px 40px;
    font-family: var(--font-galmuri11);
    background-image: 
        linear-gradient(to right, rgba(0, 0, 0, 0.05) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(0, 0, 0, 0.05) 1px, transparent 1px);
}

/* dark mode일 경우 격자 */
.dark body {
    background-image:
        linear-gradient(to right, rgba(255, 255, 255, 0.05) 1px, transparent 1px),
        linear-gradient(to bottom, rgba(255, 255, 255, 0.05) 1px, transparent 1px);
}

@layer utilities {
    .hover-glitch:hover {
        text-shadow: 2px 0 #ff00ff, -2px 0 #00ffff;
    }

    .group:hover .group-hover-glitch {
        text-shadow: 2px 0 #ff00ff, -2px 0 #00ffff;
    }

    .hover-border-glitch:hover {
        /* 원본 테두리는 유지하고, 안팎으로 그림자를 줘서 겹친 느낌 */
        box-shadow: 3px 3px 0px 0px #ff00ff, -3px -3px 0px 0px #00ffff;
        border-color: transparent; /* 필요시 원본 테두리 숨김, 혹은 유지 */
        transition: all 0.1s ease;
    }

    .group:hover .group-hover-border-glitch {
        /* 마젠타(우하단), 시안(좌상단) 그림자 테두리 */
        box-shadow: 3px 3px 0px 0px #ff00ff, -3px -3px 0px 0px #00ffff;
        
        /* 살짝 덜컹거리는 느낌을 위해 위치 이동 (선택사항) */
        transform: translate(-1px, -1px); 
        
        /* 기존 테두리 색을 덮거나 투명하게 */
        border-color: #000; /* 혹은 transparent */
    }
}

.prose details {
    display: block;
    margin-bottom: 1rem;
    background-color: rgba(128, 128, 128, 0.05); /* 배경색 살짝 추가 */
    border: 2px solid currentColor; /* pixel 테두리 */
    padding: 0.5rem;
}

.prose summary {
    cursor: pointer;
    list-style: none;
    display: flex; 
    align-items: center;
    font-weight: bold;
    outline: none; /* 클릭 시 파란 테두리 제거 */
}

@layer components {
    /* 표 전체 틀: 굵은 테두리, 픽셀 폰트 */
    .prose table {
        @apply w-full border-collapse border-2 border-black dark:border-gray-400 my-8;
        font-size: 0.9rem;
    }

    /* 헤더(th): 배경색과 이중 밑줄 */
    .prose thead th {
        @apply bg-gray-100 dark:bg-gray-800 border-2 border-black dark:border-gray-400 px-1 py-3 text-left align-middle;
        /* retro한 느낌을 위한 이중 테두리 */
        border-bottom-width: 4px;
        border-bottom-style: double;
    }

    /* 셀(td): 점선 테두리 */
    .prose tbody td {
        @apply border-r-2 border-b-2 border-dashed border-gray-300 dark:border-gray-600 px-4 align-middle;
    }

    .prose thead th:first-child,
    .prose tbody td:first-child {
        padding-left: 1rem !important; /* !important로 강제 적용 */
    }

    /* 마지막 칸은 오른쪽 선 없애기 */
    .prose tbody td:last-child {
        @apply border-r-0;
    }

    /* 마우스 하이라이트 */
    .prose tbody tr:hover {
        @apply bg-blue-50 dark:bg-blue-900/30 transition-colors cursor-default;
    }
}

/* 크롬, 사파리에서 기본 삼각형 제거 */
summary::-webkit-details-marker {
    display: none;
}

/* summary안에 있는 아이콘 크기 자동 조절 */
.prose summary svg {
    width: 1.5rem; 
    height: 1.5rem;
    margin-right: 0.5rem; 
}

/* 버튼에 픽셀 테두리 느낌 추가 */
button, .border {
    border-width: 2px !important;
    border-style: solid !important;
}

/* 인라인 코드(코드 블럭이 아닌 문장 중간에 들어가는 코드) 스타일링 */
.prose :not(pre) code {
    border-radius: 0 !important; /* 둥근 모서리 제거 */
    font-family: inherit; 
    font-weight: normal !important;
    font-style: normal !important; /* 픽셀 폰트 기울임 방지 */

    padding: 2px 5px !important; /* 간격 살짝 조정 */
    background-color: rgba(135, 131, 120, 0.15) !important; /* 연한 회색 배경 */
    color: #eb5757 !important; /* 붉은 글씨 강조 */
    border: 1px solid rgba(135, 131, 120, 0.25) !important;
}

/* 백틱 제거 */
.prose :not(pre) > code::before,
.prose :not(pre) > code::after {
    content: "" !important;
}

/* 코드 블럭 내부의 코드는 설정 무시 */
.prose pre code {
    background-color: transparent !important; 
    border: none !important; 
    color: inherit !important;
    padding: 0 !important; 
    font-family: inherit;
}

.prose img {
    max-width: 80%;
    height: auto;
    display: block; 

    /* Retro 감성 */
    border: 2px solid currentColor;
    box-shadow: 4px 4px 0px currentColor;
}

/* 두 번째 줄 끝에 콤마(,) 추가 */
.shadow-pixel {
    box-shadow:
        -2px 0 0 0 currentColor,
        2px 0 0 0 currentColor,  /* 콤마 추가됨 */
        0 -2px 0 0  currentColor,
        0 2px 0 0 currentColor;
    margin: 2px; 
}

.shadow-pixel:active {
    transform: translate(2px, 2px);
    box-shadow: none;
}

body:has(#global-not-found) aside {
    display: none !important;;
}

body:has(#global-not-found) main {
    max-width: 100% !important;  /* 최대 너비 제한 해제 */
    width: 100% !important;      /* 전체 너비 사용 */
    margin: 0 !important;        /* 여백 제거 */
    padding-top: 0 !important;    /* 위쪽 여백 제거 */
    padding-bottom: 0 !important; /* 아래쪽 여백 제거 */
    padding-left: 0 !important;
    padding-right: 0 !important;
}

.mermaid {
    width: 100%;
    display: flex;
    justify-content: center;
}