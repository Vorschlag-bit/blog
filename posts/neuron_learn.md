---
title: "신경망은 어떻게 '학습'할까?"
date: "2026-01-08 22:09:23"
category: "딥러닝"
description: "신경망이 자동으로 학습하는 과정에 대해서 알아보자"
---

## 신경망 학습
'학습'이란 <b>훈련 데이터로부터 가중치 매개변수의 최적값을 자동으로 획득</b>하는 걸 의미한다.
이를 가능하게 하는 것은 지표인 손실 함수이다. '학습'의 목표는 손실 함수의 결괏값을 가장 작게 만드는 가중치 매개변수를 찾는 것이다.

손실 함수의 값을 가급적 작게 만드는 기법으로, 함수의 기울기를 활용하는 경사법이 있다.

## 데이터로부터 학습
신경망의 특징은 데이터를 보고 학습할 수 있다는 점이다. 데이터에서 학습한다는 건 가중치 매개변수의 값을 데이터를 보고 자동으로 결정한다는 것이다.

만약 모든 매개변수를 수작업으로 결정한다면 딥러닝은 존재하지 않았을 것이다. 당장 퍼셉트론에서도 매개변수의 값은 사람이 직접 설정했었다, 허나 이때는 매개변수가 고작 3개였지만 실제 신경망에서 매개변수는 수천에서 수만 개가 존재한다.

거기서 층을 더 깊게 한다면 억에서 조로 넘어갈지도 모른다. 이런 어마어마하게 큰 수를 수작업으로 하는 것은 불가능하다. 이 글에서는 신경망 학습(데이터로부터 매개변수의 값을 정하는 법)에 대해서 학습하고 파이썬으로 MNIST 데이터셋의 손글씨 숫자를 학습하는 코드를 구현한다.

### 데이터 주도 학습
머신러닝에서 가장 중요한 것은 데이터이다. 데이터로부터 답을 찾고, 패턴을 발견하는 과정 자체가 머신러닝이기 때문이다.

사람과 머신러닝은 이 점이 문제해결에 있어서 가장 큰 차이점이라고 볼 수 있다.  
사람은 경험과 직관을 바탕으로 시행착오를 거쳐 작업을 진행한다. 하지만 머신러닝은 사람의 개입을
최소화하고 수집한 데이터로부터 패턴을 찾으려고 시도한다. 또한 신경망과 딥러닝은 기존 머신러닝에서 사용하던 방법보다 사람의 개입을 더욱 배재하는 특성을 갖고 있다.

만약 손글씨를 인식하는 프로그램을 구현한다고 했을 때, 명확한 규칙성이 없기 때문에 구현의 난이도가 매우 어렵다는 걸 알 수 있다. 따라서 알고리즘을 구체적으로 설계하기 보단 차라리
주어진 데이터를 바탕으로 특징을 학습하는 게 나을 거라는 생각이 들 것이다.

여기서 말하는 특징은 입력 데이터(입력 이미지)에서 본질적인 데이터를 정확하게 추출할 수 있도록 설계된 변환기를 말하낟. 이런 특징을 사용해 이미지 데이터를 벡터로 변환하고, 변환된 벡터를 갖고 지도 학습 방식의 대표 분류 기법인 SVM,KNN 등으로 학습할 수 있다.

이처럼 머신러닝에서 모아진 데이터로부터 규칙을 찾아내는 역할을 기계가 수행한다. 다만 이미지를 벡터로 변환할 때 사용할 특징은 여전히 사람이 선택해야 한다는 점에 주의하자.

이 말은 문제에 적합한 특징을 쓰지 않으면 훌륭한 결과를 얻을 수 없다는 것이다. 즉, 특징과 머신러닝을 활용한 접근에도 '사람'이 적절한 특징을 생각해내야 한다.

반면 신경망(딥러닝)은 사람이 일절 개입하지 않는다. 신경망은 이미지를 '있는 그대로' 학습한다. 특징과 머신러닝까지는 특징에 대해 사람이 설계를 했으나, 신경망은 이미지를 포함한 특징까지도 기계가 스스로 학습한다.

이러한 점으로 딥러닝을 종단간 머신러닝이라고도 한다. 여기서 종단간은 '처음부터 끝까지'라는 의미로 데이터에서 목표한 결과를 사람의 개입 없이 얻는다는 뜻이다.

신경망의 이점은 모든 문제를 같은 맥락에서 풀 수 있다는 점이다. 예를 들어 '5'를 인식하는 문제든, '햄버거'를 인식하는 문제든 어떠한 세부사항과 관계없이 신경망은 데이터를 온전히 학습하고 주어진 문제의 '패턴'을 발견하려고 시도한다.

즉, 신경망은 모든 문제를 주어진 데이터 그대로를 입력 데이터로 활용해 'end to end'로 학습할 수 있다.

### 훈련 데이터와 시험 데이터
머신러닝에서 데이터를 취급할 때 주의할 점이 있다. 머신러닝 문제는 데이터를 '훈련 데이터'와 '시험 데이터'로 나눠 학습과 실험을 수행하는 것이 일반적이다.

우선 훈련 데이터만 사용해 최적의 매개변수를 찾는다. 그런 다음 시험 데이터를 사용해 앞서 훈련한 모델의 실력을 평가한다.

왜 훈련 데이터와 시험 데이터를 분리해야 할까? 우리가 원하는 건 범용성을 갖춘 모델이기 때문이다. 이 범용성을 제대로 평가하기 위해선 훈련 데이터와 시험 데이터를 분리해야 한다.

범용성은 아직 훈련하지 않은 데이터로도 문제를 올바르게 풀어낼 수 있는 능력이다. 머신러닝의 최종 목표는 곧 범용성 획득이다.

만약 수중에 있는 훈련 데이터만 잘 판별한다면 그 데이터만 학습했을 가능성이 크다. 따라서 데이터셋 하나로만 매개변수의 학습과 평가를 수행하면 올바른평가가 될 수 없다. 수중 데이터셋은 제대로 맞히더라도 다른 데이터셋은 엉망일 수 있다.

참고로 데이터셋에 지나치게 최적화된 상태를 <b>과대적합(overfitting)</b>이라고 한다.

## 손실 함수
신경망 학습에선 현재 상태를 '하나의 지표'로 표현한다. 그리고 그 지표를 가장 좋게 만들어주는
가중치 매개변수의 값을 탐색한다. 신경망 학습에서 사용하는 이 '하나의 지표'는 <b>손실 함수(loss function)</b>라고 한다.

이 손실 함수는 임의의 함수를 사용할 수 있으나 일반적으로는 오차제곱합과 교차 엔트로피 오차를 사용한다.

손실 함수는 신경망 성능의 '나쁨'을 나타내는 지표로, 현재 신경망이 훈련 데이터를 얼마나 잘 처리하지 못하는가를 나타낸다. 성능상 나쁨이 적은 것은 좋다는 의미이므로 수행에 있어서 문제는 없다.

### 오차제곱합
가장 많이 쓰이는 손실 함수는 오차제곱합(sum of squares for error)이다. 수식으로는 아래와 같다.
$$
E = \frac{1}{2} \sum_{k} (y_k - t_k)^2
$$
여기서 $y_k$는 신경망의 출력(신경망이 추정한 값), $t_k$는 정답 레이블, $k$는 데이터의 차원 수를 의미한다.

오차제곱합은 각 원소의 출력(추정 값)과 정답 레이블(참 값)의 차($y_k-t_k$)를 제곱한 후에 그 총합을 구한다. python으로 구현하면 아래와 같다.

```python
def sum_squares_error(y,t):
    return 0.5 * np.sum((y-t)**2)
```

이 함수를 사용해서 실제 데이터에 대한 학습하는 간단한 예시를 보자.

```python
# 정답은 2(one-hot encoding) 정답 레이블
t = [0,0,1,0,0,0,0,0,0,0]
# 2가 제일 높을 거라고 추정한 추정값 배열
y = [0.1,0.05,0.6,0.0,0.05,0.1,0.0,0.0,0.0]
sum_squares_error(np.array(y),np.array(t))
# return == 0.0975....
```


